'use strict';

(function() {
    var app = this;
    var instance;

    var config = {
        canvasWidth: 100,
        canvasHeight: 100,
        stepDelay: 1000,
        appearDelay: 1000
    };

    var Game = function _Game() {
        if(instance !== undefined) {
            return instance;
        }

        instance = this;

        this.initialize();
    };

    Game.prototype.initialize = function _initialize() {
        this.food = [];
        this.time = 0;

        this.player = new app.Player({
            canvasWidth: config.canvasWidth,
            canvasHeight: config.canvasHeight
        });

        this.startCreatingOfFood();

        this.startTimer();
        this.bindKeyboard();
        return this;
    };

    Game.prototype.getCanvasSize = function _getCanvasSize() {
      return {width: config.canvasWidth, height: config.canvasHeight};
    };

    Game.prototype.bindKeyboard = function _bindKeyboard() {

    };

    Game.prototype.startTimer = function _startTimer() {
        var _this = this;
        this.timer = setInterval(function() {
            _this.time++;
        }, 1000);
    };

    Game.prototype.startCreatingOfFood = function _startCreatingOfFood() {
        var _this = this;
        setInterval(function() {
            _this.food.push(new app.Meal({
                canvasWidth: config.canvasWidth,
                canvasHeight: config.canvasHeight,
                delay: config.stepDelay
            }));
        }, config.appearDelay);
    };

    app.Game = Game;

    return app.Game;

}).call(window.VGN = window.VGN || {});
'use strict';

(function() {
    var app = this;

    //Private method
    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    var Meal = function _Meal(options) {
        var _this = this;

        this.getType = function _getType() {
            return props.type;
        };

        this.getPosition = function _getPosition() {
            return {x: props.x, y: props.y};
        };

        this.setPosition = function _setPosition(x, y) {
            props.x = x;
            props.y = y;

            return this.getPosition();
        };

        this.getCanvasSize = function _getCanvasSize() {
            return {height: props.canvasHeight, width: props.canvasWidth};
        };

        //Private properties
        var options = options || {};
        var props = {
            canvasWidth: options.canvasWidth || 100,
            canvasHeight: options.canvasHeight || 100,
            step: options.step || 1000,
            type: this.pickType()
        };

        var startPos = this.setStartPosition();

        this.setPosition(startPos.x, startPos.y);

        this.directon = ((props.x === props.canvasWidth || props.y === props.canvasHeight) ? '-' : '+') +  (((props.x === props.canvasWidth || props.x === props.canvasHeight)) ? 'x' : 'y');

        this.counter = setInterval(function() {
            _this.go();
        }, props.step);
    };

    Meal.prototype.checkPosition = function() {
        var position = this.getPosition();
        var canvas = this.getCanvasSize();

        return ((position.x < canvas.width && position.x > 0) && (position.y < canvas.height && position.y > 0));
    };

    Meal.prototype.go = function _go() {
        var position = this.getPosition();

        switch(this.directon) {
            case '-x':
                this.setPosition(position.x - 1, position.y); break;
            case '+x':
                this.setPosition(position.x + 1, position.y); break;
            case '-y':
                this.setPosition(position.x, position.y - 1); break;
            case '+y':
                this.setPosition(position.x, position.y + 1); break;
        }

        if(!this.checkPosition()) {
            this.destroy();
        }

        return this;
    };

    Meal.prototype.destroy = function _destroy() {
        clearInterval(this.counter);
    };

    Meal.prototype.setStartPosition = function _setStartPosition() {
        var x,
            y,
            canvas = this.getCanvasSize(),
            side = getRandomInt(1,4);

        switch (side) {
            case 1:
                y = canvas.height; x = getRandomInt(1, canvas.width - 1); break;
            case 2:
                x = canvas.width; y = getRandomInt(1, canvas.height - 1); break;
            case 3:
                y = 0; x = getRandomInt(1, canvas.width - 1); break;
            case 4:
                x = 0; y = getRandomInt(1, canvas.height - 1); break;
        }

        return {x: x, y: y};
    };

    Meal.prototype.pickType = function _pickType() {
        if(getRandomInt(0, 1)) {
            return 'meat';
        }

        return 'vegetable';
    };


    app.Meal = Meal;

    return app.Meal;
}).call(window.VGN = window.VGN || {});
'use strict';

(function() {
    var app = this;
    var instance;

    var Player = function _Player(options) {
        if(instance !== undefined) {
            return instance;
        }

        instance = this;

        //Private properties
        var props = {
            x: 0,
            y: 0,
            canvasHeight: options.canvasHeight || 100,
            canvasWidth: options.canvasWidth || 100,
            playerName: options.playerName || 'Player'
        };

        //Set starting position
        props.x = Math.round(props.canvasWidth / 2);
        props.y = Math.round(props.canvasHeight / 2);

        //Methods which depends on private properties
        this.getPosition = function _getPosition() {
            return {x: props.x, y: props.y};
        };

        this.getCanvasSize = function _getCnvasSize() {
            return {width: props.canvasWidth, height: props.canvasHeight};
        };

        this.setPosition = function _setPosition(x, y) {
            if(!this.checkPosition(x, y)) {
                return false;
            }

            props.x = x;
            props.y = y;

            return this.getPosition();
        };
    };

    Player.prototype.checkPosition = function _checkPosition(x, y) {
        var canvasSize = this.getCanvasSize();

        if((x < 0) || (x > canvasSize.width) || (y < 0) || (y > canvasSize.height)) {
            return false;
        }
        return true;
    };

    Player.prototype.go = function _go(direction) {
        var position = this.getPosition();

        switch(direction) {
            case 'up':
                return this.setPosition(position.x, position.y + 1); break;
            case 'right':
                return this.setPosition(position.x + 1, position.y); break;
            case 'down':
                return this.setPosition(position.x, position.y - 1); break;
            case 'left':
                return this.setPosition(position.x - 1, position.y); break;
            default:
                return false;
        }
    };

    app.Player = Player;

    return app.Player;
}).call(window.VGN = window.VGN || {});
window.game = new window.VGN.Game();

setInterval(function() {
    var canvas = game.getCanvasSize();
    var player = game.player.getPosition();
    var food = game.food;

    var html = '<h1>The Game</h1>' +
        '<p> Canvas size: ' + canvas.width + ' x ' + canvas.height + ' </p>' +
        '<h2>Player</h2>' +
        '<p> Position: X = ' + player.x + '; Y = ' + player.y + ' </p>';

    for(var i = 0; i < food.length; i++) {
        var type =  food[i].getType();
        var pos = food[i].getPosition();
        html += '<h3>Meal</h3><p>Type:' + type + '<br>Position: X = ' + pos.x + '; Y = ' + pos.y + '</p>'
    }
    document.body.innerHTML = html;
}, 10);
